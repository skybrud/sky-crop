var SkyCrop=function(t,e){"use strict";function i(){y(),v()}function n(t,e){void 0===e&&(e=!0),(e?g:p).push(t),"undefined"==typeof window||w||(window.addEventListener("resize",i),w=!0)}function o(t,e){void 0===e&&(e=!0);var n=e?g:p,o=n.indexOf(t);o>-1&&n.splice(o,1),"undefined"==typeof window||!w||p.length||g.length||(window.removeEventListener("resize",i),w=!1)}function r(t,e,i,n){var o={},r=function(t){return{width:Math.round(t.width),height:Math.round(t.height),ratio:t.ratio}},h=function(t){return 100*Math.ceil(t*n/100)};return{width:function(){return o.width=h(e.dimensions.width),o.height=Math.ceil(o.width/i),o.ratio=i,r(o)},height:function(){return o.height=h(e.dimensions.height),o.width=Math.ceil(o.height*i),o.ratio=i,r(o)},cover:function(){var t=e.dimensions.width/e.dimensions.height;return o.ratio=i,i>t?(o.height=h(e.dimensions.height),o.width=Math.round(o.height*i)):(o.width=h(e.dimensions.width),o.height=Math.round(o.width/i)),r(o)},contain:function(){var t=e.dimensions.width/e.dimensions.height;return o.ratio=i,i>t?(o.width=h(e.dimensions.width),o.height=Math.round(o.width/i)):(o.height=h(e.dimensions.height),o.width=Math.round(o.height*i)),r(o)}}[t]()}function h(t,e,i,n){return r(i,e,t.width/t.height,n)}function s(t,e,i){var n=t.split("/"),o=n[n.length-1].split("x")[0],r=n[n.length-1].split("x")[1],s=Boolean(Number(o))&&Boolean(Number(r)),u=null,a={width:Number(o),height:Number(r)};return{crop:function(o){return s||(a=Object.assign({},o.dimensions),console.warn("Module sky-crop: Container dimension used! Provided url did not contain width and/or height parameters '"+t+"'")),u=h(a,o,e,i),n[n.length-1]=u.width+"x"+u.height,{url:n.join("/"),dimensions:u}}}}function u(t,e,i){var n=t.slice(0,t.indexOf("?")),o=t.slice(t.indexOf("?")+1,t.length).split("&"),r=null,s=null,u=[],a=null;s=function(t){return{pad:"contain",boxpad:"contain",contain:"contain",min:"cover",max:"cover",cover:"cover",crop:"cover",width:"width",height:"height"}[t]}(e);var d=function(t){return-1!==t.indexOf("height")||-1!==t.indexOf("width")};return u=o.filter(function(t){return!d(t)}),a=o.reduce(function(t,e){return d(e)&&(t[e.split("=")[0]]=Number(e.split("=")[1])),t},{}),{crop:function(t){var e=[];return r=h(a,t,s,i),Object.keys(r).forEach(function(t){"ratio"!==t&&e.push(t+"="+r[t])}),{url:n+"?"+u.join("&")+"&"+e.join("&"),dimensions:r}},focalPoint:-1!==t.indexOf("anchor=center")||-1===t.indexOf("center=")?"50%,50%":u.reduce(function(t,e){return-1!==e.indexOf("center")&&(t=100*Number(e.split("=")[1].split(",")[1])+"%,",t+=100*Number(e.split("=")[1].split(",")[0])+"%"),t},"")}}function a(t,e,i){var n={"source.unsplash":s,media:u},o=Object.keys(n).find(function(e){return-1!==t.indexOf(e)});return void 0===o?n.media(t,e,i):n[o](t,e,i)}function d(){var t={width:640,height:360,ratio:320/180},e=function(e,i){var n=function(t,e){return"string"!=typeof e?e:-1===t.className.indexOf(e)?n(t.parentNode,e):t},o=n(e,i||"sky-crop");t.width=o.clientWidth,t.height=o.clientHeight,t.ratio=o.clientWidth/o.clientHeight;var r=function(){t.width=o.clientWidth,t.height=o.clientHeight,t.ratio=t.width/t.height};return{element:o,dimensions:t,reMeasure:r}};return{dimensions:t,domBasedSetup:e}}function c(t,e,i){var n=function(t){return Math.ceil(e[t]/i.dpr+i.round)},o=!0,r=function(){return t.dimensions.ratio>e.ratio&&!o?(o=!0,!0):t.dimensions.ratio<e.ratio&&o?(o=!1,!0):t.dimensions.ratio===e.ratio&&(o=!0,!0)},h={width:function(){return t.dimensions.width>n("width")},height:function(){return t.dimensions.height>n("height")},contain:function(){return h.width()&&h.height()},cover:function(){return h.width()||h.height()}};return{recrop:h[i.mode],restyle:r}}function l(t,e,i,n){var o=function(t){var e=!!t;return e=e&&-1!==t.indexOf(","),e=e&&t.indexOf("%")>=1,(e=e&&t.indexOf("%")!==t.lastIndexOf("%"))||void 0===t||console.warn("Sky-crop: Invalid focalpoint '"+t+"' - focalpoint defaulted to: '50%,50%'"),e?t:"50%,50%"}(i),r={x:Number(o.split(",")[0].replace("%","")),y:Number(o.split(",")[1].replace("%",""))},h={cover:function(){return{objectFit:n.mode,objectPosition:"left "+r.x+"% top "+r.y+"%",height:"100%",width:"100%"}},contain:function(){return{objectFit:n.mode,objectPosition:"50% 50%",height:"100%",width:"100%"}}},s={center:{x:{width:"auto",height:"100%",top:r.y+"%",left:"50%",transform:"translate(-50%, -"+r.y+"%)"},y:{width:"100%",height:"auto",top:"50%",left:r.x+"%",transform:"translate(-"+r.x+"%, -50%)"}},coverFit:{x:{width:"100%",height:"auto",top:r.y+"%",left:r.x+"%",transform:"translate(-"+r.x+"%, -"+r.y+"%)"},y:{width:"auto",height:"100%",top:r.y+"%",left:r.x+"%",transform:"translate(-"+r.x+"%, -"+r.y+"%)"}},containFit:{x:{width:"100%",height:"auto",top:"50%",left:"0",transform:"translate(0%, -50%)"},y:{width:"auto",height:"100%",top:"0",left:"50%",transform:"translate(-50%, 0%)"}}},u={width:function(){return e.dimensions.ratio>=t.ratio?s.coverFit.x:s.center.y},height:function(){return e.dimensions.ratio<=t.ratio?s.coverFit.y:s.center.x},contain:function(){return e.dimensions.ratio<=t.ratio?s.containFit.x:s.containFit.y},cover:function(){return e.dimensions.ratio<=t.ratio?s.coverFit.y:s.coverFit.x}},a={width:function(){return{height:"100%"}},height:function(){return{width:"100%"}}};return function(){return n.auto?a[n.auto]():!n.useObjectFit||"cover"!==n.mode&&"contain"!==n.mode?u[n.mode]():h[n.mode]()}}function f(t){var e="undefined"!=typeof window,i=["width","height","cover","contain"],n=e&&Boolean(window.CSS&&window.CSS.supports||window.supportsCSS||!1),o=n&&window.CSS.supports("object-fit","cover")&&window.CSS.supports("object-position","0% 0%"),r=e?window.devicePixelRatio:1,h=t.round||100,s=t.mode||"width",u=null;return"width"===t.auto&&(u="width",s="height"),"height"!==t.auto&&t.mode||(u="height",s="width"),t.mode&&-1===i.indexOf(t.mode)&&console.warn("Sky-crop[configProvider]: '"+t.mode+"' does not exist - 'width' set as fallback. Available modes: "+i.join(" | ")),t.auto&&"height"!==t.auto&&"width"!==t.auto&&console.warn("Sky-crop[configProvider]: "+t.auto+" is not a valid value. Use 'width' or 'height'"),{useObjectFit:n&&o,auto:u,mode:s,dpr:r,round:h}}function m(t){var e=d(),i=f(t),n=a(t.src,i.mode,i.dpr),o=n.crop(e),r=t.focal||n.focalPoint,h=l(o.dimensions,e,r,i),s=function(s){var u=e.domBasedSetup(s,t.container);i=f(t),o=n.crop(u);var a=c(u,o.dimensions,i);h=l(o.dimensions,u,r,i);var d=function(){return h()},m=function(){return u.reMeasure(),a.restyle()};return{container:u,crop:function(){u.reMeasure(),o=n.crop(u)},dimensions:o.dimensions,recalcStyles:d,shouldRecrop:a.recrop,shouldRestyle:m,src:o.url,styling:h(),get config(){return i}}};return{shouldRecrop:function(){return!1},shouldRestyle:function(){return!1},src:o.url,styling:h(),domBasedSetup:s}}var p=[],g=[],w=!1,y=function(){for(var t=p.length-1;t>=0;t--)p[t]()},v=(e=e&&e.hasOwnProperty("default")?e.default:e)(function(){for(var t=g.length-1;t>=0;t--)g[t]()},300),x={on:n,off:o};!function(){if("undefined"!=typeof document){var t=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style"),i=" /*# sourceMappingURL=SkyCrop.vue.map */";e.type="text/css",e.styleSheet?e.styleSheet.cssText=i:e.appendChild(document.createTextNode(i)),t.appendChild(e)}}();var S={name:"SkyCrop",props:{src:{type:String,required:!0},container:String,mode:String,auto:String,round:[String,Number],focalpoint:String,alt:String},data:function(){return{skyWindow:{restyle:null,recrop:null},imageArray:[],image:null,defaultCrop:!0}},computed:{default:function(){return{src:this.src,container:this.container,mode:this.mode,auto:this.auto,round:this.round,focal:this.focalpoint}}},methods:{removeOldElement:function(){this.imageArray=this.imageArray.slice(-1),this.defaultCrop=!1},newCrop:function(){return this.image.domBasedSetup(this.$el)},resizeCrop:function(){this.imageArray[0].shouldRecrop()&&(this.imageArray=this.imageArray.slice(0,1),this.imageArray.push(this.newCrop()))},resizeRestyle:function(){var t=this;this.imageArray.forEach(function(e){e.shouldRestyle()&&t.$set(e,"styling",e.recalcStyles())})}},created:function(){this.$set(this,"image",m(this.default)),this.imageArray.push(this.image)},mounted:function(){var t=this;if("height"===this.auto){var e=function(t,e){return Number(t.substr(t.indexOf(e)).split("&")[0].split("=")[1])},i=e(this.src,"width")/e(this.src,"height");this.$el.style.height=this.$el.getBoundingClientRect().width/i+"px",this.$nextTick(function(){t.$el.style.height=null})}this.auto||x.on(this.resizeRestyle,!1),x.on(this.resizeCrop),this.imageArray.push(this.newCrop())},beforeDestroy:function(){this.auto||x.off(this.resizeRestyle,!1),x.off(this.resizeCrop)}},b={registerComponents:!0},O={install:function(t,e){Object.assign({},b,e).registerComponents&&t.component(S.name,S)}};return t.SkyCrop=S,t.default=O,t}({},_throttle);
